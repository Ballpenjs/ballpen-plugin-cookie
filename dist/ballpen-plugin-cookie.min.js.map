{"version":3,"file":"ballpen-plugin-cookie.min.js","sources":["../src/ballpen-plugin-cookie.js"],"sourcesContent":["class Converter {\r\n\tstatic init(converter = {}) {\r\n\t\tthis.converter = converter;\r\n\r\n\t\treturn Converter;\r\n\t};\r\n\r\n\tstatic set(key, value, attributes = {}) {\r\n\t\tBallpenPluginCookie.core(this.converter, key, value, attributes);\r\n\t};\r\n\r\n\tstatic get(key) {\r\n\t\tBallpenPluginCookie.core.call(BallpenPluginCookie.core, this.converter, key);\r\n\t};\r\n\r\n\tstatic remove(key, attributes = {}) {\r\n\t\tBallpenPluginCookie.core(this.converter, key, 'null', BallpenPluginCookie.extend(attributes, {\r\n\t\t\texpires: -1\r\n\t\t}));\r\n\t};\r\n}\r\n\r\nclass BallpenPluginCookie {\r\n\tstatic extend() {\r\n\t\tvar i = 0;\r\n\t\tvar result = {};\r\n\t\tfor (; i < arguments.length; i++) {\r\n\t\t\tvar attributes = arguments[ i ];\r\n\t\t\tfor (var key in attributes) {\r\n\t\t\t\tresult[key] = attributes[key];\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\r\n\tstatic withConverter(converter) {\r\n\t\treturn Converter.init(converter);\r\n\t};\r\n\r\n\tstatic core(converter = false, key, value, attributes) {\r\n\t\tvar result;\r\n\t\tvar optoString = Object.prototype.toString;\r\n\r\n\t\tif (typeof document === 'undefined') {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// Write\r\n\t\tif (value) {\r\n\t\t\t// Merge attributes\r\n\t\t\tattributes = BallpenPluginCookie.extend({\r\n\t\t\t\tpath: '/'\r\n\t\t\t}, attributes);\r\n\r\n\t\t\tif (typeof attributes.expires === 'number') {\r\n\t\t\t\tvar expires = new Date();\r\n\t\t\t\t// By seconds\r\n\t\t\t\texpires.setMilliseconds(expires.getMilliseconds() + (attributes.expires / (60 * 60 * 24))  * 864e+5);\r\n\t\t\t\tattributes.expires = expires;\r\n\t\t\t}\r\n\r\n\t\t\t// We're using \"expires\" because \"max-age\" is not supported by IE\r\n\t\t\tattributes.expires = attributes.expires ? attributes.expires.toUTCString() : '';\r\n\r\n\t\t\ttry {\r\n\t\t\t\tif (optoString.call(value) === \"[object Object]\" || optoString.call(value) === \"[object Array]\") {\r\n\t\t\t\t\tvalue = JSON.stringify(value);\r\n\t\t\t\t}\r\n\t\t\t} catch (e) {}\r\n\t\t\t\r\n\t\t\tif (!converter && !converter.write) {\r\n\t\t\t\tvalue = encodeURIComponent(String(value))\r\n\t\t\t\t\t.replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g, decodeURIComponent);\r\n\t\t\t} else if(!converter.write) {\r\n\t\t\t\tvalue = converter(value, key);\r\n\t\t\t} else {\r\n\t\t\t\tvalue = converter.write(value, key);\r\n\t\t\t}\r\n\r\n\t\t\tkey = encodeURIComponent(String(key));\r\n\t\t\tkey = key.replace(/%(23|24|26|2B|5E|60|7C)/g, decodeURIComponent);\r\n\t\t\tkey = key.replace(/[()]/g, escape);\r\n\r\n\t\t\tvar stringifiedAttributes = '';\r\n\r\n\t\t\tfor (var attributeName in attributes) {\r\n\t\t\t\tif (!attributes[attributeName]) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\tstringifiedAttributes += '; ' + attributeName;\r\n\t\t\t\tif (attributes[attributeName] === true) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\tstringifiedAttributes += '=' + attributes[attributeName];\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\treturn (document.cookie = (key + '=' + value + stringifiedAttributes));\r\n\t\t}\r\n\r\n\t\t// Read\r\n\t\tif (!key) {\r\n\t\t\tresult = {};\r\n\t\t}\r\n\r\n\t\t// To prevent the for loop in the first place assign an empty array\r\n\t\t// in case there are no cookies at all. Also prevents odd result when\r\n\t\t// calling \"get()\"\r\n\t\tvar cookies = document.cookie ? document.cookie.split('; ') : [];\r\n\t\tvar rdecode = /(%[0-9A-Z]{2})+/g;\r\n\t\tvar i = 0;\r\n\r\n\t\tfor (; i < cookies.length; i++) {\r\n\t\t\tvar parts = cookies[i].split('=');\r\n\t\t\tvar cookie = parts.slice(1).join('=');\r\n\r\n\t\t\tif (cookie.charAt(0) === '\"') {\r\n\t\t\t\tcookie = cookie.slice(1, -1);\r\n\t\t\t}\r\n\r\n\t\t\ttry {\r\n\t\t\t\tvar name = parts[0].replace(rdecode, decodeURIComponent);\r\n\r\n\t\t\t\tif (converter) {\r\n\t\t\t\t\tif (converter.read) {\r\n\t\t\t\t\t\tcookie = converter.read(cookie, name);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tcookie = converter(cookie, name);\t\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcookie = cookie.replace(rdecode, decodeURIComponent);\r\n\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\ttry {\r\n\t\t\t\t\tcookie = JSON.parse(cookie);\r\n\t\t\t\t} catch (e) {}\r\n\t\t\r\n\t\t\t\tif (key === name) {\r\n\t\t\t\t\tresult = cookie;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (!key) {\r\n\t\t\t\t\tresult[name] = cookie;\r\n\t\t\t\t}\r\n\t\t\t} catch (e) {}\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t};\r\n\r\n\tstatic set(key, value, attributes = {}) {\r\n\t\tBallpenPluginCookie.core(false, key, value, attributes);\r\n\t};\r\n\r\n\tstatic get(key) {\r\n\t\treturn BallpenPluginCookie.core.call(this, false, key);\r\n\t};\r\n\r\n\tstatic remove(key, attributes = {}) {\r\n\t\tBallpenPluginCookie.core(false, key, 'null', BallpenPluginCookie.extend(attributes, {\r\n\t\t\texpires: -1\r\n\t\t}));\r\n\t};\r\n}\r\n\r\nexport default BallpenPluginCookie;\r\n"],"names":["Converter","converter","key","value","attributes","core","this","call","BallpenPluginCookie","extend","i","result","arguments","length","init","optoString","Object","prototype","toString","document","expires","Date","setMilliseconds","getMilliseconds","toUTCString","JSON","stringify","e","write","encodeURIComponent","String","replace","decodeURIComponent","escape","stringifiedAttributes","attributeName","cookie","cookies","split","rdecode","parts","slice","join","charAt","name","read","parse"],"mappings":"shBAAMA,qFACOC,yEACNA,UAAYA,EAEVD,8BAGGE,EAAKC,MAAOC,+DACFC,KAAKC,KAAKL,UAAWC,EAAKC,EAAOC,+BAG3CF,KACUG,KAAKE,KAAKC,EAAoBH,KAAMC,KAAKL,UAAWC,kCAG3DA,MAAKE,+DACEC,KAAKC,KAAKL,UAAWC,EAAK,OAAQM,EAAoBC,OAAOL,YACvE,cAKNI,2FAEAE,GAAI,EACJC,KACGD,EAAIE,UAAUC,OAAQH,IAAK,IAC7BN,GAAaQ,UAAWF,OACvB,GAAIR,KAAOE,KACRF,GAAOE,EAAWF,SAGpBS,yCAGaV,SACbD,GAAUc,KAAKb,qCAIlBU,GADOV,0DAAmBC,eAAKC,eAAOC,eAEtCW,EAAaC,OAAOC,UAAUC,YAEV,mBAAbC,cAKPhB,EAAO,MAEGK,EAAoBC,aAC1B,KACJL,GAE+B,gBAAvBA,GAAWgB,QAAsB,IACvCA,GAAU,GAAIC,QAEVC,gBAAgBF,EAAQG,kBAAqBnB,EAAWgB,cAA6B,SAClFA,QAAUA,IAIXA,QAAUhB,EAAWgB,QAAUhB,EAAWgB,QAAQI,cAAgB,OAG7C,oBAA3BT,EAAWR,KAAKJ,IAA2D,mBAA3BY,EAAWR,KAAKJ,OAC3DsB,KAAKC,UAAUvB,IAEvB,MAAOwB,MAEJ1B,GAAcA,EAAU2B,MAGlB3B,EAAU2B,MAGZ3B,EAAU2B,MAAMzB,EAAOD,GAFvBD,EAAUE,EAAOD,GAHjB2B,mBAAmBC,OAAO3B,IAChC4B,QAAQ,4DAA6DC,sBAOlEH,mBAAmBC,OAAO5B,MAC1BA,EAAI6B,QAAQ,2BAA4BC,sBACxC9B,EAAI6B,QAAQ,QAASE,WAEvBC,GAAwB,OAEvB,GAAIC,KAAiB/B,GACpBA,EAAW+B,QAGS,KAAOA,EAC5B/B,EAAW+B,MAAmB,OAGT,IAAM/B,EAAW+B,WAGnChB,UAASiB,OAAUlC,EAAM,IAAMC,EAAQ+B,EAI3ChC,iBAODmC,GAAUlB,SAASiB,OAASjB,SAASiB,OAAOE,MAAM,SAClDC,EAAU,mBACV7B,EAAI,EAEDA,EAAI2B,EAAQxB,OAAQH,IAAK,IAC3B8B,GAAQH,EAAQ3B,GAAG4B,MAAM,KACzBF,EAASI,EAAMC,MAAM,GAAGC,KAAK,IAER,OAArBN,EAAOO,OAAO,OACRP,EAAOK,MAAM,GAAG,WAIrBG,GAAOJ,EAAM,GAAGT,QAAQQ,EAASP,sBAEjC/B,EACCA,EAAU4C,KACJ5C,EAAU4C,KAAKT,EAAQQ,GAEvB3C,EAAUmC,EAAQQ,GAGnBR,EAAOL,QAAQQ,EAASP,0BAIxBP,KAAKqB,MAAMV,GACnB,MAAOT,OAELzB,IAAQ0C,EAAM,GACRR,QAILlC,MACG0C,GAAQR,GAEf,MAAOT,WAGHhB,gCAGGT,EAAKC,MAAOC,+DACFC,MAAK,EAAOH,EAAKC,EAAOC,+BAGlCF,SACHM,GAAoBH,KAAKE,KAAKD,MAAM,EAAOJ,kCAGrCA,MAAKE,+DACEC,MAAK,EAAOH,EAAK,OAAQM,EAAoBC,OAAOL,YAC9D"}